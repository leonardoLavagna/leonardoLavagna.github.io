---
title: 'A Layerwise-Multi-Angle Approach to Fine-Tuning the Quantum Approximate Optimization Algorithm'
date: 2024-05-24
permalink: /posts/2024/05/blog-post-1/
tags:
  - conference_paper
---

[@NESYA](https://github.com/NesyaLab) we have introduced a novel [variational quantum algorithm](https://arxiv.org/abs/2012.09265) built upon the established [Quantum Approximate Optimization Algorithm (QAOA)](https://arxiv.org/abs/1411.4028). Since the known [parameter fixing strategy](https://arxiv.org/abs/2108.05288) imposes some constraints to enhance tractability at the cost of some expressive power, the proposed layerwise approach integrates it with the existing [Multi-Angle QAOA technique](https://arxiv.org/abs/2109.11455) (MA-QAOA), which is characterized in turn by heightened expressiveness through an increased number of parameters, but with increased optimization challenges. Consequently, our approach, the layerwise-Multi-Angle QAOA (LMA-QAOA) combines the strengths of one variant with the limitations of the other, striking a balance in algorithmic design.

Combinatorial Optimization Problems, the MaxCut and the QAOA.
======
Like any QAOA-type method, the proposed LMA-QAOA aims to solve [combinatorial optimization problems](https://en.wikipedia.org/wiki/Combinatorial_optimization), especially [NP-hard problems](https://en.wikipedia.org/wiki/NP-hardness) arising from [Quadratic Unconstrained Binary Optimization (QUBO)](https://en.wikipedia.org/wiki/Quadratic_unconstrained_binary_optimization) tasks of interest for real-world applications such as logistics, energy grids, social network modeling, warehouse location, and so forth.<br>
&nbsp;&nbsp; We can think of a combinatorial optimization problem as a triple $(\mathcal{P},f,Alg)$, where $\mathcal{P}$ is a finite set of $m$ (classical) logical propositions, $f:\{0,1\}^n\to \mathbb{Z}$ is the cost function associating a $n$-bit string $z$ to the number of satisfied clauses of the form $$f(z)=\sum_{P\in\mathcal{P}}f_P(z) \leq m,$$ with $f_P(z)=1$ if and only if $z=z_1z_2\dots z_n$ satisfy $P$, and $Alg$ is an optimization algorithm that finds $z'$ or $z''$ such that $f(z')=\max f(z)$ or $f(z'')=\min f(z)$, respectively.<br>
&nbsp;&nbsp; Since many combinatorial optimization problems arise from graph structures, we focused on a prototypical problem, the [MaxCut](https://en.wikipedia.org/wiki/Maximum_cut), where a graph $\Gamma=(V,E)$ with $n$ vertices (nodes) $v_i\in V$ and $m\leq\frac{n(n-1)}{2}$ undirected edges $\{i,j\}\in E$ is to be partitioned into two set of vertices $S$ and $V\setminus S$ such that the number of edges $E$ connecting the nodes in the two parts is maximal. Clearly, the MaxCut problem can be extended to graphs with weighted edges, and the general cost function of is: $$f(z)=\sum_{i,j}w_{ij}(1-z_iz_j),$$ where $w_{ij}=w_{ji}>0$ is the weight associated to the edge between node $v_i$ and node $v_j$, $z_i=1$ when $v_i\in S$, $z_i=0$ otherwise.<br>
&nbsp;&nbsp; A QUBO problem can be mapped to an observable $H$ corresponding to the Hamiltonian of the [Ising model](https://en.wikipedia.org/wiki/Ising_model), in the case of the MaxCut $H$ has the form $$H(\sigma)=\sum_{i,j}w_{ij}(\mathbf{1}-\sigma_z^{(i)}\sigma_z^{(j)}),$$
where the optimal solutions correspond to fundamental states of $H(\sigma)$, retrievable via [quantum adiabatic computations](https://en.wikipedia.org/wiki/Adiabatic_quantum_computation), in particular, with QAOA, following the steps summarized below.
- Choose [basis encoding](https://arxiv.org/abs/2311.10375) $z\to |z\rangle$ and prepare an initial state $|\psi_0\rangle$ as a uniform superposition $$|\psi_0\rangle=\frac{1}{\sqrt{2^n}}\sum_{z}\ket{z},$$ where the sum is extended over all standard basis elements of $(\mathbb{C}^2)^{\otimes n}$ encoding the bit strings $z\in \{0,1\}^n$.
- Map $f(z)$ to $f(\sigma)$ by promoting each binary variable $z_i$ to a [Pauli Z-gate](https://en.wikipedia.org/wiki/Quantum_logic_gate) $\sigma_z^{(i)}$, then define the following unitary operator by considering, for every integer $k=1,\dots, p$, a rotation $U_f(\gamma_k)=e^{-i\gamma_k f(\sigma)}$ that is a product of $m$ terms. Note that $f(\sigma)$ has the form of a quantum Ising Hamiltonian.
-  For every $k=1,\dots, p$ choose a mixer operator, which is another rotation $U(\beta_k)=e^{-i\beta_k\sum_{j=1}^n \sigma_x^{(j)}}$ given as a product of $n$ terms, each of which is a [Pauli X-gate](https://en.wikipedia.org/wiki/Quantum_logic_gate) with rotation angle $\beta_k$.
- Let $|\gamma\beta\rangle:=U(\beta_p)U_f(\gamma_p)\cdot\dots\cdot U(\beta_{1})U_f(\gamma_{1})|\psi_0\rangle$ be the evolved state and let $F_p$ be the expectation of $f$ with respect to this state obtained by repeated measurements, that is $F_p(\gamma,\beta):=\langle \gamma\beta| f(\sigma)\ |\ \gamma\beta\rangle$.
- Pass $F_p$ to a classical optimizer to get an updated set of parameters $\gamma',\beta'$ and repeat the process starting from the previous steps, updating the number of layers $p\to p+1$. Stop when the approximation ratio $r_{C,C'}$, which depends on the quotient of $C'=F_p(\gamma',\beta')$ by the true optimal solution $C$ of the problem (or a reasonable upper bound) is as close as 1 as desired.

&nbsp;&nbsp; When there is a different rotation angle for each node and each edge, we have the MA-QAOA variant, which has an increased expressive power thanks to the extended number of parameters. Unfortunately such powerful methodologies involve a gread number of parameters which are hard to optimize and update, due to the complex structure of the cost function $F_p$ arising from the corresponding quantum circuits, often displaying an exponential number of local optima. In this sense, parameters' classical training can be carried out following different strategies. Besides the random approach, where at each layer random angles are drawn, other possibilities are: a symmetry-driven approach, where the space of parameters is reduced following the (classical) symmetries of the problem; a grid-search approach; a layerwise approach where, at each step, new parameters are chosen taking into account the result of previous optimization steps. In the proposed LMA-QAOA, successively introduced, we focus on parameter fixing strategies in order to reduce the optimization difficulties associated with the MA-QAOA circuit. In fact, the symmetry-driven approach has shown [promising results in many applications](https://arxiv.org/abs/2012.04713), but it often involve non-trivial preprocessing thus adding an overhead to the quantum-classical computation.

You can have many headings
======

Aren't headings cool?
------
